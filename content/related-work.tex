% !TEX root = ../thesis.tex

\chapter{Related Work}

% https://www.blackhat.com/docs/asia-17/materials/asia-17-Matrosov-The-UEFI-Firmware-Rootkits-Myths-And-Reality.pdf
% https://www.researchgate.net/profile/Anton-Sergeev-2/publication/269310822_Too_young_to_be_secure_Analysis_of_UEFI_threats_and_vulnerabilities/links/551306b50cf23203199aa237/Too-young-to-be-secure-Analysis-of-UEFI-threats-and-vulnerabilities.pdf

scholar ranking
bootkits and rootkits often share the same attack vector towards windows because they are executed prior and during windows boot

UEFI threats can be catigorized by their attack vector into two groups: storage based and memory based attacks. Storage based attacks mostly gain access independent of the current state of the operating system by only modifying the disk's content before the operating system access these files. These attacks are often performed before any parts of the operating system are executed. Memory based attacks instead hook into the operating system's boot process to install their payload alongside operating system in memory.

\section{Storage based}

% https://github.com/hackedteam/vector-edk

\subsection{LoJax}

% https://www.welivesecurity.com/wp-content/uploads/2018/09/ESET-LoJax.pdf

rootkit
documentation about firmware infection
remove previous NTFS driver
add malicious DXE driver
has NTFS driver
payload
registry editor
\lstinline{C:/Windows/SysWOW64/autoche.exe} is not executed with elevated privileges (can't update TPM values)

\lstinline{EFI_EVENT_GROUP_READY_TO_BOOT} (too early for BitLogger)


\subsection{MosaicRegressor}
% https://securelist.com/mosaicregressor/98849/
% https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/10/07080558/MosaicRegressor_Technical-details.pdf

rootkit
has NTFS driver
\lstinline{C:/ProgramData/Microsoft/Windows/Start Menu/Programs/Startup}
no registry editing, also not privileged

\section{Memory based}

% https://github.com/quarkslab/dreamboot
% https://github.com/Mattiwatti/EfiGuard
% https://pdfs.semanticscholar.org/68e7/42523f493b78111031a5a221a8cf767064f4.pdf

\subsection{FinSpy}

% https://securelist.com/finspy-unseen-findings/104322/

bootkit
bootmgfw.efi replaced and orignal moved
original bootloader patched in memory
patches "function of the OS loader that transfers execution to the kernel"
hooks the kernel's PsCreateSystemThread and which then creates an addtional thread decrypting the next stage and loading it


\subsection{ESPecter}
% https://www.welivesecurity.com/2021/10/05/uefi-threats-moving-esp-introducing-especter-bootkit/

bootkit


\subsection{MoonBounce}
% https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/

\subsection{CosmicStrand}
% https://securelist.com/cosmicstrand-uefi-firmware-rootkit/106973/