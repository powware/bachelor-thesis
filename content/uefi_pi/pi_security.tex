% !TeX root = ../../thesis.tex

\subsection{Security}

\subsubsection{Hardware Validated Boot}
Secure Boot relies for the firmware as its root of trust, hardware validated boot shifts this trusts out of the firmware image into hardware.
amd
% https://ebrary.net/24869/computer_science/secure_technology
% https://www.amd.com/system/files/documents/amd-security-white-paper.pdf
intel
% https://edk2-docs.gitbook.io/understanding-the-uefi-secure-boot-chain/secure_boot_chain_in_uefi/intel_boot_guard

with pi offering security PPI and dxe protocols for this

PEI Guided Section Extraction PPI
Security PPI

Guided Section Extraction Protocol
Security Architecture Protocol
Security2 Architecture Protocol


\subsubsection{Firmware Protection}

The \ac{DXE} phase also offers drivers to register notification
% End of Dxe Event
% From SEC through the signaling of this event, all of the components should be under the authority of
% the platform manufacturer and not have to worry about interaction or corruption by 3rd party
% extensible modules such as UEFI drivers and UEFI applications.

% Platform may choose to lock certain resources or disable certain interfaces prior to executing third
% party extensible modules. Transition from the environment where all of the components are under
% the authority of the platform manufacturer to the environment where third party modules are
% executed is a two-step process:

% 1. End of DXE Event is signaled. This event presents the last opportunity to use resources or
% interfaces that are going to be locked or disabled in anticipation of the invocation of 3rd party
% extensible modules.
% 2. DXE SMM Ready to Lock Protocol is installed. PI modules that need to lock or protect their
% resources in anticipation of the invocation of 3rd party extensible modules should register for
% notification on installation of this protocol and effect the appropriate protections in their
% notification handlers


% https://papers.vx-underground.org/papers/Other/Advanced%20Malware/UEFI%20Secure%20Boot%20in%20Modern%20Computer%20Security%20Solutions.pdf
% NIST 800-147 BIOS Protection Guidelines [15]
% NIST 800-147B BIOS Protection Guidelines for Servers [16]
% NIST 800-155 BIOS Integrity Measurement Guidelines [17]


% https://eclypsium.com/2019/10/23/protecting-system-firmware-storage/

DXE SMM Ready to Lock Vol4




flash device security







\subsubsection{TPM}
\subsubsection{TPM measurements}
% https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/
% https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/3_TCG_Trusted_Boot_Chain_in_EDKII.html
% https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/6_Checklist_for_Platform_Developers.html
% https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-fundamentals
% https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/trusted-platform-module-overview
% what is TPM
A \acf{TPM} is a system component which enables trust in computing platforms
helps verify if the Trusted Computing Base has been compromised
securely storing passwords, certificates and encryption keys in separate state to host
only communicating through a well defined interface.
store platform measurements that help ensure that the platform remains trustworthy
authentication
attestation
hardware and software implementations
software special mode shielding TPM resources from normal execution
\cite{tcg-tpm-summary}
\cite{tcg-tpm-library-part1-architecture}

% what is done with the measurements
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-overview
how are they used
works with bitlocker to protect user data
ensure computer has not been tampered with while offline

% what is measured
statically configured, unchangeable data
not dynamic and changeable across the boot,
\cite{tianocore-trusted-boot-chain}

\begin{table}
    \centering
    \begin{tabular}{ c|p{30em}  }
        \acs{PCR} Index & \multicolumn{1}{c}{\acs{PCR} Usage}                                                                      \\
        \hline
        0               & SRTM, BIOS, Host Platform Extensions, Embedded Option ROMs and PI Drivers                                \\
        \hline
        1               & Host Platform Configuration                                                                              \\
        \hline
        2               & UEFI driver and application Code                                                                         \\
        \hline
        3               & UEFI driver and application Configuration and Data                                                       \\
        \hline
        4               & UEFI Boot Manager Code (usually the MBR) and Boot Attempts                                               \\
        \hline
        5               & Boot Manager Code Configuration and Data (for use by the Boot Manager Code) and \ac{GPT}/Partition Table \\
        \hline
        6               & Host Platform Manufacturer Specific                                                                      \\
        \hline
        7               & Secure Boot Policy                                                                                       \\
        \hline
        8               & First \ac{NTFS} boot sector (volume boot record)                                                         \\
        \hline
        9               & Remaining \ac{NTFS} boot sectors (volume boot record)                                                    \\
        \hline
        10              & Boot Manager                                                                                             \\
        \hline
        11              & BitLocker Access Control                                                                                 \\
    \end{tabular}

    % \label{}
    \caption{\cite{tcg-pc-client-platform-firmware-profile-spec, windows-internals-6-part2}}
\end{table}


% https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/media/image2.png

% https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/3_TCG_Trusted_Boot_Chain_in_EDKII.html
% Table 2 PCR usage (simple rules)

% https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/media/image3.png

% when is it measured
\cite{tianocore-trusted-boot-chain}

% where is it measured
\ac{TCG}2 Protocol
Trusted Computing Group 2 (TCG2) Protocol \cite[Section 6.7.3]{tcg-efi-protocol-spec}

% secret storage, seal and unseal
