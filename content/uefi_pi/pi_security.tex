% !TeX root = ../../thesis.tex

\subsection{Security}
\label{sec:uefi-pi:pi:security}

The \ac{PI} specification defines \acp{PPI} and \ac{DXE} protocols which can be used to validate images when loading them.
During the \ac{PEI} phase the \emph{\ac{PEI} Guided Section Extraction \ac{PPI}} can be used to authenticate of file sections, while the \emph{Security \ac{PPI}} implements the policy response to the authentication result.
The \ac{DXE} phase has counter parts in the form of \emph{Guided Section Extraction Protocol} and \emph{Security Architectural Protocol}.
The policy response may be the locking of flash upon authentication failure or attestation logging \cite[Vol. 2, Section 12.9.1]{pi-spec}.
It also has the architectural protocol \emph{Security2 Architectural Protocol}, which implements Secure Boot validation, \ac{TCG} measured boot and User Identity policy for image loading.
The implementation of the boot service \code{LoadImage} has to use these protocols in accordance to the rules defined in \cite[Vol. 2, Section 12.9.2]{pi-spec}.
The Security2 protocol is invoked on every image loaded, with the Security protocol being invoked afterwards on images loaded through the Firmware Volume Protocol.
When the Security2 protocol is not installed it uses the Security protocol regardless of the image's origin.


\subsubsection{Hardware Validated Boot}


Secure Boot relies on the firmware as its root of trust, hardware validated boot is able to shift this trusts out of the firmware image into hardware, in hopes to reduce attack vectors.


amd
% https://ebrary.net/24869/computer_science/secure_technology
% https://www.amd.com/system/files/documents/amd-security-white-paper.pdf
intel
% https://edk2-docs.gitbook.io/understanding-the-uefi-secure-boot-chain/secure_boot_chain_in_uefi/intel_boot_guard

\subsubsection{Firmware Protection}

The \ac{PI} speficiation defines an \emph{End of Dxe Event}, which indicates the introduction of third party software execution to the platform.
Up until this point it is assumed that the entire system software is under the control of the platform manufacturer.
Drivers may react to this event by locking critical system resources, by using the \ac{SMM} services \cite[Vol. 2, 5.1.2.1]{pi-spec}.
The \ac{SMM} is a secure execution environment, achieved by isolation from the rest of the system, through the \ac{CPU} \cite[Vol. 4, Section 1.3]{pi-spec}.


% https://papers.vx-underground.org/papers/Other/Advanced%20Malware/UEFI%20Secure%20Boot%20in%20Modern%20Computer%20Security%20Solutions.pdf
% NIST 800-147 BIOS Protection Guidelines [15]
% NIST 800-147B BIOS Protection Guidelines for Servers [16]
% NIST 800-155 BIOS Integrity Measurement Guidelines [17]


% https://eclypsium.com/2019/10/23/protecting-system-firmware-storage/

