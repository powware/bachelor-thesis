% !TeX root = ../thesis.tex

% https://www.scribbr.com/research-paper/discussion/

meaning, importance, and relevance of your results
explaining and evaluating what you found, showing how it relates to your literature review

\chapter{Discussion}

we achieved a boot and rootkit with unrestricted disk access which results in elevated execution on the target OS
persistence with rootkit/none with bootkit
bootkit delivery:
usb stick, from windows
rootkit delivery:
spi clamp, firmware delivery process, maybe windows with exploit

bootkit vs rootkit
bootkit:
installation is much easier:
windows installer
physical presence with bootable usb stick
defeated by secure boot
in case of physical presence it may require to change boot order
bios password mitigates that
if no password present we can disable secure boot
not entirely persistent
fresh reinstallation with partition removal and general hard drive replacements defeat it

rootkit:
barrier of entry is higher
physical access is more difficult than just booting from a usb stick
exploit to override spi flash or be delivered with supply chain difficult
but high payoff
persistence across reinstallations or hard drive replacements
can prevent further bios updates and be unremovable
secure boot does not include internal DXE drivers
option ROM rootkit is defeated by secure boot
spi reflash may disable secure boot by changing variable anyways
SMM rootkit very powerful, complete control over the system
% \cite{}  https://pdfs.semanticscholar.org/68e7/42523f493b78111031a5a221a8cf767064f4.pdf


we didnt try to be undetectable
windows is very vulnerable with unrestricted disk access
secure boot is very limited
secure boot can easily be disabled without bios password
TPM does its job in detecting PCR change
% attack assumption reflected to real world aplicability
bitlocker reocvery prompt can raise suspicion
very effective if part of the delivery process or in general present before os installation
BitLogger somewhat last resort
social engineering aspect
you can change recovery message and URL in BCD hive


% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-countermeasures#bootkits-and-rootkits

boottime vs runtime rootkit

\section{Rootkit classification}

statisken zu bilocker und secureboot auf systemen

industrie standard zur system security in firmen

\section{Mitigations}

bios password against secure boot removal

windows cant assume what the implementation of ReadKeyStrokeEx looks like (normally function patching might have a jump etc, which we dont even have here)

hardware validated boot

inaccessible spi flash

tpm + pin/usb detectability

\subsection{User awareness}


% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-recovery-guide-plan

recovery guide

what causes bitlocker recovery
- password wrong too often
- TPM 1.2, changing the BIOS or firmware boot device order
- Having the CD or DVD drive before the hard drive in the BIOS boot order and then inserting or removing a CD or DVD
- Failing to boot from a network drive before booting from the hard drive.
- Docking or undocking a portable computer
- Changes to the NTFS partition table on the disk including creating, deleting, or resizing a primary partition.
- Entering the personal identification number (PIN) incorrectly too many times
- Upgrading critical early startup components, such as a BIOS or UEFI firmware upgrade
- Updating option ROM firmware graphics card
- Adding or removing hardware
- REMOVING, INSERTING, OR COMPLETELY DEPLETING THE CHARGE ON A SMART BATTERY ON A PORTABLE COMPUTER
- Pressing the F8 or F10 key during the boot process
what does the recovery screen say

% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-device-encryption-overview-windows-10
% https://learn.microsoft.com/en-us/mem/configmgr/protect/deploy-use/bitlocker/helpdesk-portal?source=recommendations
% https://learn.microsoft.com/en-us/microsoft-desktop-optimization-pack/mbam-v25/
Enables end users to recover encrypted devices independently by using the Self-Service Portal

googeln wie legitime recovery key prompt reaktion aussieht

enterprise policy recovery key einschraenkbar?

enterprise policy on recovery key loss

vermitteln was das prompt bedeuten koennte

aber kann man einfach nicht anzeigen lassen

Security Flaw of entering a Recovery Password in an inheritly unsafe System

enterprise doesnt hand out recovery keys and instead receives hard drive


!!!!!!!!!!!!!!!!!!!!!!!!!
without hardware chain of trust a compromised system can patch/change any software and fixes are impossible

phishing prompts on their own