% !TeX root = ../thesis.tex

% https://www.scribbr.com/research-paper/discussion/

% meaning, importance, and relevance of your results
% explaining and evaluating what you found, showing how it relates to your literature review

\chapter{Discussion}


The biggest takeaway of our attacks is, that BitLocker\-/protected Windows 11 installations are less secure against \ac{UEFI} rootkits when using Secure Boot.
We disprove Microsoft's statement that \textcquote{microsoft-pcr7-binding}{Windows is secure regardless of using \ac{TPM} profile \code{\{0, 2, 4, 11\}} or profile \code{\{7, 11\}}}.
Excluding \ac{PCR}0 in the validation profile and relying soley on Secure Boot for integrity validation is a flawed approach, as this is not part of Secure Boot's threat model.
Secure Boot quite in the contrarty relies on the firmware as its root of trust, meaning it is not able to validate the behavior of the \ac{PI} process.
Secure Boot's purpose is to enforce authentiation when the \ac{PF} interacts with \ac{UEFI} images outside of the firmware image.
Microsoft's decision to use Secure Boot for integrity validation leaves a lot of systems more vulnerable than they should be.
Any attacker with read and write access to the firmware image is able to gain control over such a system.
This is especially easy for attackers with physical access with a stolen laptop being a prime candidate for the attack.
trade off between false positives and security
not using \ac{PCR}7 instead of \ac{PCR}0 and 2
measured boot \TODO{maybe}
tpm + pin/usb detectability stolen laptop fix
could also be keylogged, but cant update protectors






When BitLocker is correctly configured and includes \ac{PCR}0, to use the \ac{TPM} for integrity validation, the security advantage is still highly dependend on the user's reaction to the recovery prompt.
We argue that the significance of its appearance is dismissed by providing the ability for the user to enter the recovery key.
Microsoft had to make a trade\-/off between forcing users to take false positives as serious as actual threats and giving the user a security override without any way to differentiat
the fact that a user can override the security reaction when they enter the recovery key.
The instead of a recovery prompt the user should be made aware of the inherent loss of system integrity.
Very dangerous situation to deal with, because on the other hand false positives would require the same attention.




\ac{TPM} integrity measurements are only as effective as the user's reaction to them, they are opt\-/out by overriding the security decision with a recovery key.
impact and significance
realistically what is a user gonna do
generally the bitlocker reocvery prompt can raise suspicion and may lead to investigations and the threat to be found
BitLogger is more of a last resort and a social engineering aspect comparable to phishing


bootkit installation easier than rootkit

rootkit with physical access many options/easy to do


it is generally very easy to attack windows from the \ac{UEFI} environment and there is little that they can do, as especially all windows code can be patched
didnt prevent firmware update overwriting our payload




Our attacks reveal the differences between \ac{UEFI} firmware rootkits and \ac{UEFI} bootkits.
The barrier of entry for a bootkit is much lower, as through physical access it is only required to boot from a \ac{USB} stick.
Remote infection by mounting the \ac{ESP}.
When the \ac{PF} is not password protected the main downside of a bootkit, its  we can disable secure boot
in case of physical presence it may require to change boot order
physical presence with bootable usb stick (defeated by secure boot)
genrally defeated by secure boot where as the rootkit isnt
even if secure boot was implemented for FV images, it could be patched if the validation change starts within the image

barrier of entry is higher
exploit to overwrite spi flash or be delivered with supply chain difficult
physical presence remove spi chip and emulate spi chip or modify chip content
but high payoff with persistence

% persistence
bootkit moves with hard drive but can be overwritten by fresh install
rootkit persistence across reinstallations or hard drive replacements


% SMM rootkit very powerful, complete control over the system
% \cite{}  https://pdfs.semanticscholar.org/68e7/42523f493b78111031a5a221a8cf767064f4.pdf

% attack assumption reflected to real world aplicability




\section{Mitigations}


bios password against secure boot removal or bootkit installation from USB

hardware validated boot to start the validation change from outside the image

inaccessible spi flash


\subsection{User awareness}

% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-group-policy-settings#configure-the-pre-boot-recovery-message-and-url
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bcd-settings-and-bitlocker
you can change recovery message and URL in BCD hive


% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-recovery-guide-plan

recovery guide

what causes bitlocker recovery
- password wrong too often
- TPM 1.2, changing the BIOS or firmware boot device order
- Having the CD or DVD drive before the hard drive in the BIOS boot order and then inserting or removing a CD or DVD
- Failing to boot from a network drive before booting from the hard drive.
- Docking or undocking a portable computer
- Changes to the NTFS partition table on the disk including creating, deleting, or resizing a primary partition.
- Entering the personal identification number (PIN) incorrectly too many times
- Upgrading critical early startup components, such as a BIOS or UEFI firmware upgrade
- Updating option ROM firmware graphics card
- Adding or removing hardware
- REMOVING, INSERTING, OR COMPLETELY DEPLETING THE CHARGE ON A SMART BATTERY ON A PORTABLE COMPUTER
- Pressing the F8 or F10 key during the boot process
what does the recovery screen say \autoref{fig:bitlocker-recovery-prompt}

% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-device-encryption-overview-windows-10
% https://learn.microsoft.com/en-us/mem/configmgr/protect/deploy-use/bitlocker/helpdesk-portal?source=recommendations
% https://learn.microsoft.com/en-us/microsoft-desktop-optimization-pack/mbam-v25/
Enables end users to recover encrypted devices independently by using the Self-Service Portal

googeln wie legitime recovery key prompt reaktion aussieht

enterprise policy recovery key einschraenkbar?

enterprise policy on recovery key loss

vermitteln was das prompt bedeuten koennte

aber kann man einfach nicht anzeigen lassen

Security Flaw of entering a Recovery Password in an inheritly unsafe System

enterprise doesnt hand out recovery keys and instead receives hard drive


!!!!!!!!!!!!!!!!!!!!!!!!!
without hardware chain of trust a compromised system can patch/change any software and fixes are impossible

phishing prompts on their own