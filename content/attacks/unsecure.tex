% !TeX root = ../../thesis.tex

\section{Neither Secure Boot nor Bitlocker}
use read access to dump image
% ref to background UEFI/PI IMAGE
since it an FV with FFS we can open with UEFITool
remove previous NTFS driver if present, for full control, might be read only etc
in UEFITool search and remove
add in NTFS driver
use write access

try in EFI shell
navigate to Windows folder
create folder

how does one compile uefi application with edk2
it's open source so we can look up examples for most stuff

try in code
compile dxe driver within ovmf to receive .ffs file with version depex user interface section
SimpleFileSystem Protocol iteration
write failed on hibernated file
patch to allow write on hibernated drives

pack executable binary as uefi module
edk2 produces freeform image with one raw section
iterate over firmware volume protocols
search for payload guid
check size match
override notepad works

% ref to background UAC signed
but no automatic execution nor elevated privileges
dll proxying
dll hijacking
registry editing

Task Scheduler
defined in xml
cached in registry
edit with start cmd.exe and trigger manually
whoami

chntpw and reged
port to uefi
edit Task in machine under Control
maybe look if just adding a key would have also worked
export target registry key
modify so that registry key can differ and found via matching values
import and override registry key on target machine
payload whoami
localsystem

