% !TEX root = ../thesis.tex

\chapter{Appendix}

\section{System Table}
\lstinputlisting[language=C,caption={System Table},captionpos=b,label=lst:system-table]{code/system_table.h}
\clearpage

\subsection{Boot Services}
\lstinputlisting[language=C,caption={Boot Services},captionpos=b,label=lst:boot-services]{code/boot_services.h}
\clearpage

\subsection{Runtime Services}
\lstinputlisting[language=C,caption={Runtime Services},captionpos=b,label=lst:runtime-services]{code/runtime_services.h}
\clearpage

\section{\acsp{PPI}}

\subsection{\acs{PEI} Guided Section Extraction \acs{PPI}}
\lstinputlisting[language=C,firstline=4,caption={\acs{PEI} Guided Section Extraction \acs{PPI}},captionpos=b,label=lst:pei-guided-section-extraction-ppi]{code/ppis/GuidedSectionExtraction.h}
\clearpage

\subsection{\acs{PEI} Security2 \acs{PPI}}
\lstinputlisting[language=C,firstline=4,caption={\acs{PEI} Security2 \acs{PPI}},captionpos=b,label=lst:pei-security2-ppi]{code/ppis/Security2.h}
\clearpage

\section{Protocols}

\subsection{Device Path Protocol}
\lstinputlisting[language=C,firstline=4,caption={Device Path Protocol},captionpos=b,label=lst:device-path-protocol]{code/protocols/DevicePath.h}
\clearpage

\subsection{Loaded Image Protocol}
\lstinputlisting[language=C,firstline=4,caption={Loaded Image Protocol},captionpos=b,label=lst:loaded-image-protocol]{code/protocols/LoadedImage.h}
\clearpage

\subsection{Driver Binding Protocol}
\lstinputlisting[language=C,firstline=4,caption={Driver Binding Protocol},captionpos=b,label=lst:driver-binding-protocol]{code/protocols/DriverBinding.h}
\clearpage

\subsection{Partition Information Protocol}
\lstinputlisting[language=C,firstline=4,caption={Partition Information Protocol},captionpos=b,label=lst:partition-information-protocol]{code/protocols/PartitionInfo.h}
\clearpage

\subsection{Simple File System and File Protocol}

\subsubsection{Simple File System Protocol}
\lstinputlisting[language=C,firstline=4,lastline=14,caption={Simple File System Protocol},captionpos=b,label=lst:simple-file-system-protocol]{code/protocols/SimpleFileSystem.h}

\subsubsection{File Protocol}
\lstinputlisting[language=C,firstline=16,caption={File Protocol},captionpos=b,label=lst:file-protocol]{code/protocols/SimpleFileSystem.h}
\clearpage

\subsection{Disk \acs{I/O} Protocol}
\lstinputlisting[language=C,firstline=4,caption={Disk \ac{I/O} Protocol},captionpos=b,label=lst:disk-io-protocol]{code/protocols/DiskIo.h}
\clearpage

\subsection{Block \acs{I/O} Protocol}
\lstinputlisting[language=C,firstline=4,caption={Block \ac{I/O} Protocol},captionpos=b,label=lst:block-io-protocol]{code/protocols/BlockIo.h}
\clearpage

\subsection{\acf{BDS} Architectural Protocol}
\lstinputlisting[language=C,firstline=4,caption={\acs{BDS}  Architectural Protocol},captionpos=b,label=lst:bds-protocol]{code/protocols/Bds.h}
\clearpage

\subsection{Simple Text Input Protocol}
\lstinputlisting[language=C,firstline=4,caption={Simple Text Input Protocol},captionpos=b,label=lst:simple-text-input-protocol]{code/protocols/SimpleTextIn.h}
\clearpage

\subsection{Simple Text Input Ex Protocol}
\lstinputlisting[language=C,firstline=4,caption={Simple Text Input Ex Protocol},captionpos=b,label=lst:simple-text-input-ex-protocol]{code/protocols/SimpleTextInEx.h}
\clearpage

\subsection{\acs{TCG}2 Protocol}
\lstinputlisting[language=C,firstline=4,caption={\ac{TCG}2 Protocol},captionpos=b,label=lst:tcg2-protocol]{code/protocols/Tcg2Protocol.h}

\clearpage
\subsection{Firmware Volume2 Protocol}
\lstinputlisting[language=C,firstline=4,caption={\ac{BDS} Protocol},captionpos=b,label=lst:firmware-volume2-protocol]{code/protocols/FirmwareVolume2.h}
\clearpage

\subsection{Guided Section Extraction Protocol}
\lstinputlisting[language=C,firstline=4,caption={Guided Section Extraction Protocol},captionpos=b,label=lst:guided-section-extraction-protocol]{code/protocols/GuidedSectionExtraction.h}
\clearpage

\subsection{Security Architectural Protocols}
\label{sec:appendix:protocols:security:architectual:protocols}

\subsubsection{Security Architectural Protocol}
\lstinputlisting[language=C,firstline=4,caption={Security Architectural Protocol},captionpos=b,label=lst:security-architectural-protocol]{code/protocols/Security.h}

\subsubsection{Security2 Architectural Protocol}
\lstinputlisting[language=C,firstline=4,caption={Security2 Architectural Protocol},captionpos=b,label=lst:security2-architectural-protocol]{code/protocols/Security2.h}
\clearpage

\subsection{Firmware Management Protocol}
\lstinputlisting[language=C,firstline=4,caption={Firmware Management Protocol},captionpos=b,label=lst:firmware-management-protocol]{code/protocols/FirmwareManagement.h}
\clearpage

\subsection{\acs{PCI} Root Bridge \acs{I/O} Protocol}
\lstinputlisting[language=C,firstline=4,caption={\acs{PCI} Root Bridge \acs{I/O} Protocol},captionpos=b,label=lst:pci-root-bridge-io-protocol]{code/protocols/PciRootBridgeIo.h}
\clearpage

\section{Firmware File Types}

\begin{table}[htb]
    \centering
    \small
    \begin{tabularx}{1.05\textwidth}{XcX}
        \toprule
        \textbf{Name}                                                                  & \textbf{Value}          & \textbf{Description}                                                                                                        \\
        \midrule
        \code{EFI\_FV\_FILETYPE\_RAW}                                                  & \code{0x01}             & Binary data                                                                                                                 \\
        \arrayrulecolor{gray}
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_FREEFORM}                                             & \code{0x02}             & Sectioned data                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_SECURITY\_CORE}                                       & \code{0x03}             & Platform core code used during the SEC phase                                                                                \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_PEI\_CORE}                                            & \code{0x04}             & PEI Foundation                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_DXE\_CORE}                                            & \code{0x05}             & DXE Foundation                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_PEIM}                                                 & \code{0x06}             & PEI module (PEIM)                                                                                                           \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_DRIVER}                                               & \code{0x07}             & DXE driver                                                                                                                  \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_COMBINED\_PEIM\_DRIVER}                               & \code{0x08}             & Combined PEIM/DXE driver                                                                                                    \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_APPLICATION}                                          & \code{0x09}             & Application                                                                                                                 \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_MM}                                                   & \code{0x0A}             & Contains a PE32+ image that will be loaded into MMRAM in MM Traditional Mode.                                               \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_FIRMWARE\_VOLUME\_IMAGE}                              & \code{0x0B}             & Firmware volume image                                                                                                       \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_COMBINED\_MM\_DXE}                                    & \code{0x0C}             & Contains PE32+ image that will be dispatched by the DXE Dispatcher and will also be loaded into MMRAM in MM Tradition Mode. \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_MM\_CORE}                                             & \code{0x0D}             & MM Foundation that support MM Traditional Mode.                                                                             \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_MM\_STANDALONE}                                       & \code{0x0E}             & Contains a PE32+ image that will be loaded into MMRAM in MM Standalone Mode.                                                \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_MM\_CORE\_STANDALONE}                                 & \code{0x0F}             & MM Foundation that support MM Tradition Mode and MM Standalone Mode.                                                        \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_OEM\_MIN\dots} \code{EFI\_FV\_FILETYPE\_OEM\_MAX}     & \code{0xC0}-\code{0xDF} & OEM File Types                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_DEBUG\_MIN\dots} \code{EFI\_FV\_FILETYPE\_DEBUG\_MAX} & \code{0xE0}-\code{0xEF} & Debug/Test File Types                                                                                                       \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_FFS\_MIN\dots} \code{EFI\_FV\_FILETYPE\_FFS\_MAX}     & \code{0xF0}-\code{0xFF} & Firmware File System Specific File Types                                                                                    \\
        \midrule[0.3pt]
        \code{EFI\_FV\_FILETYPE\_FFS\_PAD}                                             & \code{0xF0}             & Pad File For FFS                                                                                                            \\
        \arrayrulecolor{black}
        \bottomrule
    \end{tabularx}
    \caption[Firmware File Types]{Firmware File Types (taken from \cite[Vol. 3, Table 3-3]{pi-spec})}
    \label{tab:file-types}
    \normalsize
\end{table}

\clearpage

\section{Firmware File Section Types}

\begin{table}[htb]
    \centering
    \small
    \begin{tabularx}{1.0\textwidth}{XcX}
        \toprule
        \textbf{Name}                               & \textbf{Value} & \textbf{Description}                                                                                                                                    \\
        \midrule
        \code{EFI\_SECTION\_COMPRESSION}            & \code{0x01}    & Encapsulation section where other sections are compressed.                                                                                              \\
        \arrayrulecolor{gray}
        \midrule[0.3pt]
        \code{EFI\_SECTION\_GUID\_DEFINED}          & \code{0x02}    & Encapsulation section where other sections have format defined by a \acs{GUID}.                                                                         \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_DISPOSABLE}             & \code{0x03}    & Encapsulation section used during the build process but not required for execution.                                                                     \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_PE32}                   & \code{0x10}    & PE32+ Executable image.                                                                                                                                 \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_PIC}                    & \code{0x11}    & Position-Independent Code.                                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_TE}                     & \code{0x12}    & Terse Executable image.                                                                                                                                 \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_DXE\_DEPEX}             & \code{0x13}    & DXE Dependency Expression.                                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_VERSION}                & \code{0x14}    & Version, Text and Numeric.                                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_USER\_INTERFACE}        & \code{0x15}    & User-Friendly name of the driver.                                                                                                                       \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_COMPATIBILITY16}        & \code{0x16}    & DOS-style 16-bit EXE.                                                                                                                                   \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_FIRMWARE\_VOLUME\_IMAG} & \code{0x17}    & PI Firmware Volume image.                                                                                                                               \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_FREEFORM\_SUBTYPE\_GUI} & \code{0x18}    & Raw data with GUID in header to define format.                                                                                                          \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_RAW}                    & \code{0x19}    & Raw data.                                                                                                                                               \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_PEI\_DEPEX}             & \code{0x1B}    & PEI Dependency Expression.                                                                                                                              \\
        \midrule[0.3pt]
        \code{EFI\_SECTION\_MM\_DEPEX}              & \code{0x1C}    & Leaf section type for determining the dispatch order for an MM Traditional driver in MM Traditional Mode or MM Standalone driver in MM Standalone Mode. \\
        \arrayrulecolor{black}
        \bottomrule
    \end{tabularx}
    \caption[Firmware File Section Types]{Firmware File Section Types (taken from \cite[Vol. 3, Table 3-4]{pi-spec})}
    \label{tab:file-section-types}
    \normalsize
\end{table}
