% !TeX root = ../../thesis.tex

\section{Windows}
% https://learn.microsoft.com/en-us/windows/whats-new/windows-11-overview#security-and-scanning
\subsection{User Access Control (UAC)}
% https://learn.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works
\subsection{Signing}
\subsection{BitLocker}
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-overview
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-device-encryption-overview-windows-10
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-countermeasures
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/ts-bitlocker-decode-measured-boot-logs
% https://pulsesecurity.co.nz/articles/TPM-sniffing

% fun thing to try
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-group-policy-settings#bkmk-configurepreboot

BitLocker Drive Encryption (BDE) integrates with operating system
encryption enabled per volume
encrypt os and data drives
supports removable data drives
maximum protection with TPM 1.2 or later
alternatively USB startup key or password, not system integrity verification
optionally PIN or USB startup key required to unlock
% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-how-to-enable-network-unlock
also network unlock and pin as fallback

% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-countermeasures#pre-boot-authentication
- tpm only
no additional user interaction
- tpm with startup key
additional usb
- tpm with PIN
- tpm with startup key and PIN
protects against unauthorized data access

with tpm ensures integrity of early boot components and boot configuration


system requirement
include support for TCG-specified Static Root of Trust Measurement

% https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-device-encryption-overview-windows-10
bitlocker device encryption if supported automatically enabled
after clean install encrypted with clear key (bitlocker suspended state)
non domain account -> recovery key uploaded to microsoft account
domain account -> recovery key backed up to active directory domain services (AD DS)
clear key removed

encryption on used disk space only or whole drive
former security risk if turned on after drive was already in use, deleted data accessible with disk recovery tools
latter the following is recommended
% https://learn.microsoft.com/en-us/windows/security/information-protection/encrypted-hard-drive
encrypted hard drive support

% https://github.com/libyal/libbde/blob/main/documentation/BitLocker%20Drive%20Encryption%20(BDE)%20format.asciidoc
% how does it work
two partitions
- operating system partition with os and support files, all system files on the volume, including the paging files and hibernation files, bitlocker encrypted, ntfs
- system partition with windows boot manager and minimal software required for decryption of the os, fat32, unencrypted, files needed

data is encrypted blockwise with Full Volume Encryption Key (FVEK)
- AES 128-bit the key is 128-bit of size
- AES 256-bit the key is 256-bit of size
FVEK encrypted with Volume Master Key (VMK) 256 bit
VMK encrypted by multiple protectors, default configuration:
% https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-fundamentals
% https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/how-windows-uses-the-tpm#bitlocker-drive-encryption
- TPM, seal operation
- Recovery Key

or
- startup key/external key

\subsubsection{Recovery Key}
% https://github.com/libyal/libbde/blob/main/documentation/BitLocker%20Drive%20Encryption%20(BDE)%20format.asciidoc#24-recovery-key
recovery key 48 digits of 8 blocks
block is converted to a 16-bit value making up a 128-bit key

\subsubsection{Clear Key}
% https://github.com/libyal/libbde/blob/main/documentation/BitLocker%20Drive%20Encryption%20(BDE)%20format.asciidoc#25-clear-key
unprotected 256-bit key stored on the volume t decrypt vmk

\subsubsection{Startup Key}
% https://github.com/libyal/libbde/blob/main/documentation/BitLocker%20Drive%20Encryption%20(BDE)%20format.asciidoc#26-startup-key
stored in a .bek file with GUID name equaling key identifier in bitlocker meta data
multiple possible for a single bitlocked volume

\subsubsection{Startup Key}
% https://github.com/libyal/libbde/blob/main/documentation/BitLocker%20Drive%20Encryption%20(BDE)%20format.asciidoc#27-user-key
password with max 49 characters