% !TeX root = ../thesis.tex

\chapter{Conclusion}
\label{sec:conclusion}

Our practical analysis of \ac{UEFI} threats against Windows 11 showed that enabling Secure Boot when using BitLocker comes with a hidden reduction in security.
Microsoft misuses Secure Boot in an attempt to provide platform firmware integrity validation, where the \ac{TPM} already offers a perfectly fine solution.
With such a misconfigured BitLocker validation profile our rootkit was able to sniff the communication between the Windows Boot Manager and \ac{TPM} without introducing side effects.
Through interception of the \emph{unseal} command, we gained access to the unencrypted BitLocker \ac{VMK}, to decrypt the hard drive and deploy further payload in the Windows installation.
By then modifying the Windows registry our payload was executed with privileges of the local system account.

Microsoft also has set a dangerous precedent by offering the user a mechanism to override the security reaction to integrity violations in an inherently untrustworthy system.
In the case of a correctly configured BitLocker validation profile, the code of our root- or bootkit measured into the \ac{TPM} cause the \emph{unseal} operation to fail and the Windows Boot Manager to trigger a recovery prompt.
The burden of security enforcement is now left to the user and when they decide to put further trust into the system and enter their recovery key, our \emph{BitLogger} can record the performed keystrokes to decrypt the hard drive.

\section*{Future Work}

It would be interesting to take a closer look at memory\-/based attacks under the light of \ac{VBS} like \ac{HVCI} and how rootkits might interact with the \ac{SMM} to circumvent these security mechanisms.
Further investigations into platforms where the \ac{RTM} is being established by the \ac{SRTM} measuring itself, could reveal these implementations to be much more vulnerable against rootkits than laid out in this thesis.